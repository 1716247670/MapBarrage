(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e13a85e2"],{"343d":function(e,t,n){},9406:function(e,t,n){"use strict";n.r(t);var a,o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-card",{staticClass:"danmu-control-pannel",attrs:{shadow:"hover"}},[n("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[n("span",[e._v("弹幕操作")])]),n("el-button",{attrs:{type:"primary",size:"mini",plain:""},on:{click:e.playDanmu}},[e._v("播放")]),n("el-button",{attrs:{type:"primary",size:"mini",plain:""},on:{click:e.pauseDanmu}},[e._v("暂停")]),n("el-button",{attrs:{type:"primary",size:"mini",plain:""},on:{click:e.hideDanmu}},[e._v("隐藏")]),n("el-button",{attrs:{type:"primary",size:"mini",plain:""},on:{click:e.showDanmu}},[e._v("显示")])],1),n("el-card",{staticClass:"layer-control-pannel",attrs:{shadow:"hover"}},[n("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[n("span",[e._v("图层操作")])]),n("el-form",{attrs:{"label-width":"80px",size:"mini"}},[n("el-form-item",{attrs:{label:"轨道图层"}},[n("el-switch",{on:{change:e.toggleGridLayer},model:{value:e.gridLayerShow,callback:function(t){e.gridLayerShow=t},expression:"gridLayerShow"}})],1),n("el-form-item",{attrs:{label:"POI图层"}},[n("el-select",{on:{change:e.selectPOILayer},model:{value:e.currentLayer,callback:function(t){e.currentLayer=t},expression:"currentLayer"}},[n("el-option",{attrs:{label:"旅游景点",value:"scene"}}),n("el-option",{attrs:{label:"美食餐饮",value:"food"}}),n("el-option",{attrs:{label:"休闲娱乐",value:"fun"}})],1)],1)],1)],1),e._l(e.danmus,(function(t,a){return[n("vue-danmaku",{ref:"danmaku",refInFor:!0,staticClass:"danmaku",style:{top:"calc((100vh - 50px)/8*"+a+")"},attrs:{loop:"","use-slot":"",channels:1,randomChannel:!1,speeds:200-5*t.content.length,isSuspend:""},scopedSlots:e._u([{key:"dm",fn:function(t){t.index;var a=t.danmu;return[a.name?n("div",{staticClass:"danmaku-name"},[n("wordcloud",{attrs:{mainWord:{text:a.name,weight:10},keywordsList:a.tagList}})],1):e._e()]}}],null,!0),model:{value:t.content,callback:function(n){e.$set(t,"content",n)},expression:"danmu.content"}})]})),n("div",{attrs:{id:"map-container"}})],2)},r=[],i=n("2909"),c=n("c7eb"),s=n("1da1"),l=(n("4de4"),n("d81d"),n("fb6a"),n("4e82"),n("d3b7"),n("159b"),n("ac6d"),n("e192")),u=n.n(l),d=n("595b"),f=n("48c3"),p=n.n(f),m=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"word-container"},e._l(e.fullList,(function(t,a){return n("div",{key:a,staticClass:"grid-item",class:{"main-word":t.main},style:{fontSize:e.fontSize(t.weight),color:e.color(t.weight)}},[t.text?n("span",[e._v(" "+e._s(t.text))]):e._e()])})),0)},h=[],y=n("5530"),b=(n("a434"),{name:"WordCloud",props:{mainWord:{type:Object,default:function(){return{text:"无",weight:10}}},keywordsList:{type:Array,default:function(){return[]}}},data:function(){return{colors:["#008fbf","#239fcf","#47b0df","#6ac0ef","#8dd0ff","#dae695","#ffb8b8","#df7b7b","#c03d3d","#a00000"]}},mounted:function(){},methods:{fontSize:function(e){return"".concat(14+1*e,"px")},color:function(e){return this.colors[e-1]}},computed:{fullList:function(){var e=Object(i["a"])(this.keywordsList);return e.splice(5,0,Object(y["a"])(Object(y["a"])({},this.mainWord),{},{main:!0})),e}}}),g=b,v=(n("fdf4"),n("2877")),w=Object(v["a"])(g,m,h,!1,null,"4de58bbd",null),x=w.exports,k={name:"Dashboard",components:{vueDanmaku:p.a,wordcloud:x},computed:{},data:function(){return{danmus:[{content:["我是弹幕","好好好","嘿嘿嘿","哈哈哈"]},{content:["111","11","1","1"]},{content:["我是弹幕","好好好","嘿嘿嘿","哈哈哈"]},{content:["我是弹幕","好好好","嘿嘿嘿","哈哈哈"]},{content:["我是弹幕","好好好","嘿嘿嘿","哈哈哈"]},{content:["我是弹幕","好好好","嘿嘿嘿","哈哈哈"]},{content:["我是弹幕","好好好","嘿嘿嘿","哈哈哈"]},{content:["我是弹幕","好好好","嘿嘿嘿","哈哈哈"]}],gridLayerShow:!1,currentLayer:"food",dataPOI:{}}},mounted:function(){var e=this;function t(){if(e.stopDanmu(),e.playDanmu(),a.getSource("gridsource"))a.removeLayer("grid-layer"),a.removeSource("gridsource");else{for(var t=n(8),o=e.dataPOI,r=function(){var n=t.features[c],a=o.features.filter((function(e){return d["booleanPointInPolygon"](e,n.geometry)}));e.danmus[c].content=a.map((function(e){return e.properties}));var r=e.danmus[c].content;r.forEach((function(e){var t=[];e.overall_rating&&t.push({text:"评分:"+e.overall_rating,weight:10}),e.label&&e.label.split(",").forEach((function(e){t.push({text:e,weight:9})})),e.price&&t.push({text:"价格:"+e.price,weight:9}),e.keywords&&e.keywords.forEach((function(e,n){t.push({text:e,weight:10-n})}));while(t.length<10)t.push({text:"",weight:1});t.sort((function(){return Math.random()-.5})),e.tagList=t.slice(0,10)})),n.properties.pointCount=parseInt(a.length)},c=0;c<t.features.length;c++)r();var s=Math.max.apply(Math,Object(i["a"])(t.features.map((function(e){return e.properties.pointCount})))),l=Math.min.apply(Math,Object(i["a"])(t.features.map((function(e){return e.properties.pointCount}))));a.addSource("gridsource",{type:"geojson",data:t}),a.addLayer({id:"grid-layer",type:"fill",source:"gridsource",paint:{"fill-color":["interpolate",["linear"],["get","pointCount"],l,"rgba(0, 255, 0, 0.7)",s,"rgba(255, 0, 0, 0.7)"],"fill-opacity":.8}}),e.gridLayerShow?a.setLayoutProperty("grid-layer","visibility","visible"):a.setLayoutProperty("grid-layer","visibility","none")}}function n(e){for(var t=o(),n=t.lngMin,a=t.lngMax,r=t.latMin,i=t.latMax,c=[n,r,a,i],s=(c[3]-c[1])/e,l=[],u=0;u<e;u++){var f=c[1]+u*s,p=f+s,m=[c[0],f,c[2],p],h=d["bboxPolygon"](m);l.push(h)}var y=d["featureCollection"](l.reverse());return y}function o(){var e=a.getBounds(),t={lngMax:e._ne.wrap().lng,lngMin:e._sw.wrap().lng,latMax:e._ne.wrap().lat,latMin:e._sw.wrap().lat};return t}u.a.accessToken="pk.eyJ1IjoiemhvbmdkaXNodW1hIiwiYSI6ImNsNXJoYXR5eTI2bGgzZW53d2didWF1c3AifQ.6vOplM2NQc_xnJW3aA5ZBA",a=new u.a.Map({container:"map-container",style:"mapbox://styles/mapbox/streets-v12",center:[114.35400105,30.6512685],zoom:10,minZoom:10}),a.dragRotate.disable(),a.touchZoomRotate.disableRotation(),Object(s["a"])(Object(c["a"])().mark((function t(){return Object(c["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.createPoi(e.currentLayer);case 3:e.dataPOI=t.sent,console.log(e.dataPOI),t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),console.error("Error loading data:",t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))(),a.on("load",(function(){t(),a.addSource("wuhanSource",{type:"geojson",data:e.dataPOI}),a.addLayer({id:"icons",type:"symbol",source:"wuhanSource",layout:{"icon-image":"restaurant","icon-size":1.5,"icon-allow-overlap":!0,"text-field":["get","name"],"text-size":12,"text-offset":[0,2],"text-font":["Open Sans Bold","Arial Unicode MS Bold"],"text-max-width":8},paint:{"text-color":"#000000","text-halo-color":"#ffffff","text-halo-width":1}})})),a.on("zoomend",(function(){console.log("zoomend"),t()})),a.on("moveend",(function(){console.log("moveend"),t()}))},methods:{hideDanmu:function(){this.$refs["danmaku"].forEach((function(e){return e.hide()}))},showDanmu:function(){this.$refs["danmaku"].forEach((function(e){return e.show()}))},pauseDanmu:function(){this.$refs["danmaku"].forEach((function(e){return e.pause()}))},stopDanmu:function(){this.$refs["danmaku"].forEach((function(e){return e.stop()}))},playDanmu:function(){this.$refs["danmaku"].forEach((function(e){return e.play()}))},toggleGridLayer:function(e){e?a.setLayoutProperty("grid-layer","visibility","visible"):a.setLayoutProperty("grid-layer","visibility","none")},selectPOILayer:function(e){var t,n=this;switch(this.stopDanmu(),e){case"scene":t="attraction";break;case"food":t="restaurant";break;case"fun":t="theatre";break;default:t="marker";break}Object(s["a"])(Object(c["a"])().mark((function o(){return Object(c["a"])().wrap((function(o){while(1)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,n.createPoi(e);case 3:n.dataPOI=o.sent,a.getSource("wuhanSource").setData(n.dataPOI),a.setLayoutProperty("icons","icon-image",t),console.log(n.dataPOI),o.next=12;break;case 9:o.prev=9,o.t0=o["catch"](0),console.error("Error loading data:",o.t0);case 12:case"end":return o.stop()}}),o,null,[[0,9]])})))()},createPoi:function(e){if("food"==e||"fun"==e||"scene"==e)return new Promise((function(t,n){fetch("./data/".concat(e,".json")).then((function(e){return e.json()})).then((function(e){var n=d["featureCollection"](e.features);t(n)})).catch((function(e){n(e)}))}))}}},L=k,O=(n("fc4e"),Object(v["a"])(L,o,r,!1,null,"0a8baf0e",null));t["default"]=O.exports},c8e8:function(e,t,n){},fc4e:function(e,t,n){"use strict";n("c8e8")},fdf4:function(e,t,n){"use strict";n("343d")}}]);